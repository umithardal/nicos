description = 'qmesydaq detector devices'

# included by kompass
group = 'lowlevel'

nethost = 'kompasssrv.kompass.frm2'

sysconfig = dict(
    datasinks = ['LivePNGSink', 'LivePNGSinkLog',
                 ],#'Histogram', 'Listmode'],
)

devices = dict(
    LiveViewSink = device('nicos.devices.datasinks.LiveViewSink',
        description = 'Sends image data to LiveViewWidget',
        filenametemplate=[],
    ),
    LivePNGSinkLog = device('nicos.devices.datasinks.PNGLiveFileSink',
        description = 'Saves live image as .png every now and then',
        filename = '/kompasscontrol/webroot/live_log.png',
        log10 = True,
        interval = 15,
    ),
    LivePNGSink = device('nicos.devices.datasinks.PNGLiveFileSink',
        description = 'Saves live image as .png every now and then',
        filename = '/kompasscontrol/webroot/live_lin.png',
        log10 = False,
        interval = 15,
    ),
    Histogram = device('nicos_mlz.devices.qmesydaqsinks.HistogramSink',
        description = 'Histogram data written via QMesyDAQ',
        image = 'det1_image',
        subdir = 'mtxt',
        filenametemplate = ['%(pointcounter)07d.mtxt'],
        detectors = ['det'],
    ),
    Listmode = device('nicos_mlz.devices.qmesydaqsinks.ListmodeSink',
        description = 'Listmode data written via QMesyDAQ',
        image = 'det1_image',
        subdir = 'list',
        filenametemplate = ['%(pointcounter)07d.mdat'],
        detectors = ['det'],
    ),
    det1_mon1 = device('nicos.devices.vendor.qmesydaq.taco.Counter',
        description = 'QMesyDAQ Counter0',
        tacodevice = '//%s/kompass/qmesydaq/counter0' % nethost,
        type = 'monitor',
    ),
    det1_mon2 = device('nicos.devices.vendor.qmesydaq.taco.Counter',
        description = 'QMesyDAQ Counter1',
        tacodevice = '//%s/kompass/qmesydaq/counter1' % nethost,
        type = 'monitor',
    ),
    det1_mon3 = device('nicos.devices.vendor.qmesydaq.taco.Counter',
        description = 'QMesyDAQ Counter2 (reference for tisane)',
        tacodevice = '//%s/kompass/qmesydaq/counter2' % nethost,
        type = 'monitor',
    ),
    det1_mon4 = device('nicos.devices.vendor.qmesydaq.taco.Counter',
        description = 'QMesyDAQ Counter2 (reference for tisane)',
        tacodevice = '//%s/kompass/qmesydaq/counter3' % nethost,
        type = 'monitor',
    ),
    det1_ev = device('nicos.devices.vendor.qmesydaq.taco.Counter',
        description = 'QMesyDAQ Events channel',
        tacodevice = '//%s/kompass/qmesydaq/events' % nethost,
        type = 'counter',
    ),
    det1_timer = device('nicos.devices.vendor.qmesydaq.taco.Timer',
        description = 'QMesyDAQ Timer',
        tacodevice = '//%s/kompass/qmesydaq/timer' % nethost,
    ),
    det1_image = device('nicos.devices.vendor.qmesydaq.taco.Image',
        description = 'QMesyDAQ Image',
        tacodevice = '//%s/kompass/qmesydaq/det' % nethost,
    ),
    det1_raw = device('nicos.devices.vendor.qmesydaq.taco.Image',
        description = 'QMesyDAQ RAW Image',
        tacodevice = '//%s/kompass/qmesydaq/detraw' % nethost,
    ),
    det1_amp = device('nicos.devices.vendor.qmesydaq.taco.Image',
        description = 'QMesyDAQ Amplitudes',
        tacodevice = '//%s/kompass/qmesydaq/detamp' % nethost,
    ),
    det1 = device('nicos.devices.generic.Detector',
        description = 'QMesyDAQ Image type Detector1',
        timers = ['det1_timer'],
        monitors = ['det1_mon1', 'det1_mon2', 'det1_mon3', 'det1_mon4'],
        images = ['det1_image'],
        liveinterval = 30.0,
    ),
)

startupcode = '''
SetDetectors(det1)
'''
